function [y_, t_, dt_] = RKF45_step(t, y, dt, mu, tolerance)
k1 = dt * f(t, y, mu);
k2 = dt * f(t + dt/4, y + k1/4, mu);
k3 = dt * f(t + (3/8)*dt, y + (3/32)*k1 + (9/32)*k2, mu);
k4 = dt * f(t + (12/13)*dt, y + (1932/2197)*k1 - (7200/2197)*k2 + (7296/2197)*k3, mu);
k5 = dt * f(t + dt, y + (439/216)*k1 - 8*k2 + (3680/513)*k3 - (845/4104)*k4, mu);
k6 = dt * f(t + 0.5*dt, y - (8/27)*k1 + 2*k2 - (3544/2565)*k3 + (1859/4104)*k4 - (11/40)*k5, mu);

y_ = y + (25/216)*k1 + (1408/2565)*k3 + (2197/4101)*k4 -(1/5)*k5;
z_ = y + (16/135)*k1 + (6656/12825)*k3 + (28561/56430)*k4 - (9/50)*k5 + (2/55)*k6;

error = max(abs(z_ - y_));
s = (tolerance / (2 * error)) ^ (1/4);
dt_ = s * dt;
t_ = t + dt;
end 